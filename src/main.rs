use std::{collections::HashSet, fs::read_to_string};
use clap::Parser;

#[derive(Parser, Debug)]
#[command(version, about, long_about = None)]
struct Args {
    /// File path to open
    #[arg(short, long)]
    path: Option<String>
}

fn main() {
    let args = Args::parse();
    let mut ip_addr: Vec<&str> = Vec::new();

    let log_path = match args.path {
        Some(path) => path,
        None => String::from("/var/log/auth.log")
    };
    
    let lines = read_to_string(log_path).unwrap();  // ip-blocklist-dirty is from auth.log
    let binding_lines = lines.lines();
    for line in binding_lines {
        let l: Vec<&str> = line.split(' ').collect();
        ip_addr.push(l[9]);
    }

    let ip_addr_unique: HashSet<&str> = ip_addr.into_iter().collect();
    println!("{:?}", ip_addr_unique);

}
